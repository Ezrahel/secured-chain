# Server Configuration
PORT=8080
HOST=localhost
ENV=development

# Database
DATABASE_URL=postgres://authuser:authpass@localhost:5432/authdb?sslmode=disable
DB_MAX_OPEN_CONNS=25
DB_MAX_IDLE_CONNS=5
DB_CONN_MAX_LIFETIME=5m

# JWT Configuration
JWT_ACCESS_SECRET=your-256-bit-secret-key-change-this-in-production
JWT_REFRESH_SECRET=your-256-bit-refresh-secret-key-change-this-in-production
JWT_ACCESS_EXPIRY=10m
JWT_REFRESH_EXPIRY=7d

# Password Hashing (Argon2id)
ARGON2_MEMORY=65536
ARGON2_ITERATIONS=3
ARGON2_PARALLELISM=2
ARGON2_SALT_LENGTH=16
ARGON2_KEY_LENGTH=32

# Email Configuration (Google SMTP)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@gmail.com
SMTP_PASSWORD=your-app-password
SMTP_FROM="AuthService <no-reply@yourdomain.com>"
SMTP_TIMEOUT=10s

# Email Templates
EMAIL_CONFIRM_SUBJECT="Confirm your email address"
EMAIL_RESET_SUBJECT="Reset your password"
EMAIL_CONFIRM_URL=http://localhost:8080/api/v1/confirm-email
EMAIL_RESET_URL=http://localhost:3000/reset-password

# Token Expiry
EMAIL_TOKEN_EXPIRY=24h
RESET_TOKEN_EXPIRY=1h

# Rate Limiting
RATE_LIMIT_REQUESTS_PER_MINUTE=60
RATE_LIMIT_BURST=10
AUTH_RATE_LIMIT_REQUESTS_PER_MINUTE=10
AUTH_RATE_LIMIT_BURST=3

# Account Security
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION=15m
PASSWORD_MIN_LENGTH=12

# HIBP (Have I Been Pwned) API
HIBP_API_URL=https://api.pwnedpasswords.com/range
HIBP_TIMEOUT=5s
HIBP_ENABLED=true

# CORS
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8080
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With,X-Device-ID

# Security Headers
HSTS_MAX_AGE=31536000
CSP_POLICY="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'"

# Logging
LOG_LEVEL=info
LOG_FORMAT=json

# Metrics
METRICS_ENABLED=true
METRICS_PATH=/metrics

# MFA
MFA_ISSUER=AuthService
MFA_ENABLED=true

# Redis (for rate limiting and session storage)
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=
REDIS_DB=0

# Encryption (for PII)
ENCRYPTION_KEY=your-32-byte-encryption-key-change-this